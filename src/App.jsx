import { createPortal } from "react-dom";
import "./App.css";
import BackgroundBlur from "./components/background-blur/BackgroundBlur";
import Cart from "./components/cart/Cart";
import { useEffect, useState } from "react";

function App() {
  const [showCart, setShowCart] = useState(false);
  const [renderCart, setRenderCart] = useState(false);

  function OpenCart() {
    if (renderCart) {
      setShowCart(false);
      setTimeout(() => setRenderCart(false), 230);
    } else {
      setRenderCart(true);
      setTimeout(() => setShowCart(true), 2);
    }
  }

  useEffect(() => {
    const handler = () => OpenCart();
    window.addEventListener("cart:add", handler);
    return () => window.removeEventListener("cart:add", handler);
  }, [renderCart]);
  return (
    <>
      {createPortal(
        <>
          <BackgroundBlur OpenCart={OpenCart} renderCart={renderCart} showCart={showCart}/>
          <Cart OpenCart={OpenCart} renderCart={renderCart} showCart={showCart}/>
        </>,
        document.body
      )}
      {/* <button class="nav-button f-row j-c user">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 15"><path fillRule="evenodd" d="M2.67794 3.21428c0-.85248.33865-1.67004.94144-2.272838C4.22218.338647 5.03974 0 5.89222 0c.85248 0 1.67005.338647 2.27284.941442.6028.602798.94145 1.420358.94145 2.272838 0 .85248-.33865 1.67005-.94145 2.27284-.60279.6028-1.42036.94145-2.27284.94145-.85248 0-1.67004-.33865-2.27284-.94145-.60279-.60279-.94144-1.42036-.94144-2.27284ZM.0000853 13.2893C.0241712 11.7425.655543 10.2672 1.75791 9.18184 2.86028 8.0965 4.34523 7.48817 5.89222 7.48817s3.03194.60833 4.13428 1.69367c1.1024 1.08536 1.7338 2.56066 1.7579 4.10746.0018.1041-.0267.2065-.0822.2947-.0554.0882-.1353.1583-.23.2017-1.75057.8026-3.65415 1.2169-5.57998 1.2143-1.98999 0-3.88071-.4343-5.579992-1.2143-.094653-.0434-.174589-.1135-.230027-.2017-.0554379-.0882-.0839737-.1906-.0821157-.2947Z" clipRule="evenodd"/></svg>
        </button> */}
        <button className="nav-button f-row j-c cart" onClick={OpenCart}>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 15 14"><path d="M.538462 0C.395653 0 .258693.0567305.157712.157712.0567306.258693 0 .395653 0 .538462 0 .68127.0567306.81823.157712.919211c.100981.100979.237941.157709.38075.157709h.995078c.12205 0 .22831.08185.2599.19959l1.83651 6.88657c-.57682.15029-1.0875.48766-1.45206.95926-.36455.47161-.56238 1.05086-.56251 1.64686 0 .2973.24124.5385.53847.5385H13.4615c.1428 0 .2798-.0567.3808-.1577.101-.101.1577-.238.1577-.3808 0-.1428-.0567-.2797-.1577-.3807-.101-.101-.238-.1577-.3808-.1577H2.78421c.11137-.31506.3177-.58779.59055-.78067.27285-.19287.5988-.29638.93293-.29628h8.05391c.1009 0 .1998-.02834.2853-.08177.0856-.05344.1544-.12984.1986-.22049.8197-1.68208 1.5296-3.41549 2.1252-5.18933.0235-.07018.0323-.14445.0259-.21818-.0065-.07373-.0281-.14533-.0635-.21035-.0353-.06501-.0837-.12204-.1421-.16751-.0584-.04547-.1256-.07842-.1973-.09678-3.7866-.96554-7.68556-1.41878-11.59267-1.34759L2.83446.999385c-.07642-.286648-.24539-.540024-.48064-.72075C2.11856.0979087 1.8302-.000044 1.53354 0H.538462ZM1.61538 12.9231c0-.2856.11347-.5596.31543-.7615.20196-.202.47588-.3154.7615-.3154.28562 0 .55954.1134.7615.3154.20196.2019.31542.4759.31542.7615 0 .2856-.11346.5595-.31542.7615-.20196.2019-.47588.3154-.7615.3154-.28562 0-.55954-.1135-.7615-.3154-.20196-.202-.31543-.4759-.31543-.7615Zm9.15382 0c0-.2856.1135-.5596.3155-.7615.2019-.202.4758-.3154.7615-.3154.2856 0 .5595.1134.7615.3154.2019.2019.3154.4759.3154.7615 0 .2856-.1135.5595-.3154.7615-.202.2019-.4759.3154-.7615.3154-.2857 0-.5596-.1135-.7615-.3154-.202-.202-.3155-.4759-.3155-.7615Z"/></svg>
        </button>
    </>
  );
}

export default App;
